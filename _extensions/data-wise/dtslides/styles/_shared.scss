// ============================================================
// dtslides ‚Äî Shared Styles Partial
// Color-agnostic layout, typography, and components.
// Each theme imports this and defines its own color variables.
// ============================================================

// ============================================================
// 1. Imports
// ============================================================

@import url("https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;1,300;1,400&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Fira+Code&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap");
@import url("https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css");

// ============================================================
// 2. Base Styles
// ============================================================

html {
  font-size: $presentation-font-size-root;
}

body {
  margin: 0;
  padding: 0;
  font-family: $font-family-sans-serif;
  font-size: $font-size;
  color: $body-color;
  background-color: $body-bg;
  line-height: $line-height-body;
}

.reveal {
  font-family: $font-family-sans-serif;
  color: $body-color;
  background-color: $body-bg;
  line-height: $line-height-body;

  // Override Quarto's default overflow-y:auto on .slide:not(.center)
  // which causes scrollbars on content-heavy slides instead of clipping.
  // Users can still opt in per-slide with {.scrollable}
  .slide:not(.scrollable) {
    overflow-y: hidden !important;
  }

  .slides a {
    color: $accent;
    text-decoration: underline;
    text-underline-offset: 3px;
    text-decoration-thickness: 1px;
    text-decoration-color: rgba($accent, 0.4);
  }

  img {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
  }
}

// ============================================================
// 3. Headings
// Use `.reveal` prefix to match RevealJS selector specificity.
// RevealJS uses `.reveal h1, .reveal h2, ...` with
// `margin: var(--r-heading-margin)` ‚Äî bare `h2` loses.
// ============================================================

.reveal h1 {
  color: $heading-h1-color;
  font-weight: 600;
  font-size: $presentation-h1-font-size;
  font-family: $heading-font-family;
  text-align: center;
  margin: $spacing-lg 0;
  padding: $spacing-xxl 0 $spacing-xl 0;
  line-height: $presentation-heading-line-height;
}

.reveal h2 {
  color: $heading-h2-color;
  font-weight: 500;
  font-size: $presentation-h2-font-size;
  text-align: center;
  margin: 0 0 $spacing-xl 0;
  padding: 0;
  line-height: $presentation-heading-line-height;
}

.reveal h3 {
  color: $heading-h3-color;
  font-weight: normal;
  font-size: $presentation-h3-font-size;
  padding-left: $spacing-xs;
}

.reveal h4 {
  color: $heading-h4-color;
  font-weight: normal;
  margin-top: 0;
}

// ============================================================
// 4. Code Blocks
// ============================================================

.reveal pre {
  margin: $spacing-xxs 0;
  background-color: $code-block-bg;
  border-radius: 6px;
  font-family: $code-font-family;
  font-size: $code-block-font-size;
  line-height: $code-line-height;
  overflow: auto;
  border: 0;
}

.reveal pre code {
  font-size: inherit;
  background-color: $code-block-bg;
  border-radius: 6px;
  padding: $spacing-md;
  font-family: $code-font-family;
  overflow-x: auto;
  white-space: pre-wrap;
  color: $body-color;
  border: 0;
}

.reveal code {
  font-size: 0.8em;
  padding-left: 4px;
  padding-right: 4px;
  border-radius: 6px;
  border: 0;
}

.reveal div.sourceCode {
  border: 0;
  border-radius: 6px;
  margin-bottom: 0.3em;
}

// R console output ‚Äî visually distinct from source code
.reveal div.cell-output-stdout pre,
.reveal div.cell-output pre {
  background-color: $code-output-bg;
  border-left: 3px solid $accent;
  border-radius: 0 6px 6px 0;
}

// Code source + output visual connection
// Remove gap so source and output appear as one unit.
.reveal div.sourceCode + div.cell-output {
  margin-top: 0;
}

.reveal div.cell-output {
  margin-bottom: $spacing-xs;
}

.reveal div.sourceCode {
  margin-bottom: 0;

  & + div.cell-output pre {
    margin-top: 0;
    border-radius: 0 0 6px 6px;
    border-top: 1px solid rgba($accent, 0.2);
  }
}

// Kable table output spacing
.reveal .cell {
  .sourceCode + .cell-output-display {
    margin-top: $spacing-xs;
  }

  .cell-output-display table {
    margin-top: $spacing-xs;
  }
}

// Code-with-filename styling
.reveal .code-with-filename-file pre {
  background-color: transparent;
  font-size: 80%;
}

// ============================================================
// 5. Font Size Utility Classes
// ============================================================

.largest { font-size: 1.20em; }
.larger  { font-size: 1.50em; }
.large   { font-size: 1.25em; }
.small   { font-size: 0.8em; }
.smaller { font-size: 0.64em; }
.smallest { font-size: 0.512em; }

.reveal .largest pre  { font-size: 1.20em; }
.reveal .larger pre   { font-size: 1.50em; }
.reveal .large pre    { font-size: 1.25em; }
.reveal .small pre    { font-size: 0.8em; }
.reveal .smaller pre  { font-size: 0.64em; }
.reveal .smallest pre { font-size: 0.512em; }

.reveal .largest code  { font-size: 1.56em; }
.reveal .larger code   { font-size: 1.25em; }
.reveal .large code    { font-size: 1em; }
.reveal .small code    { font-size: 0.64em; }
.reveal .smaller code  { font-size: 0.51em; }
.reveal .smallest code { font-size: 0.41em; }

// ============================================================
// 6. Text & Vertical Alignment
// ============================================================

.reveal .left   { display: block; text-align: left; }
.reveal .center { display: block; text-align: center; }
.reveal .right  { display: block; text-align: right; }

.reveal .v-center { display: grid; align-items: center; height: 90%; }
.reveal .v-top    { display: grid; align-items: start; height: 90%; }
.reveal .v-bottom { display: grid; align-items: end; height: 90%; }

// ============================================================
// 7. Lists
// ============================================================

.reveal ul li ul,
.reveal ol li ol {
  font-size: 0.9em;
}

.reveal ol {
  list-style-type: decimal;
  margin-left: $spacing-sm;
  padding-left: $spacing-sm;
}

.reveal ul {
  list-style-type: disc;
  margin-left: $spacing-sm;
  padding-left: $spacing-sm;
}

.reveal .slide ul,
.reveal .slide ol {
  line-height: 1.4;
}

.reveal .slide ul li,
.reveal .slide ol li {
  margin-top: 0.3em;
  margin-bottom: 0.3em;
}

// Tighten nested lists slightly
.reveal .slide ul li ul li,
.reveal .slide ol li ol li {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

// ============================================================
// 8. Tables
// ============================================================

.reveal table {
  width: 85%;
  margin: $spacing-sm auto;
  border-collapse: collapse;
  font-family: $font-family-sans-serif;
  font-size: $font-size-small;
  padding: $spacing-md;

  tr:nth-child(even) {
    background-color: $table-stripe-bg;
  }

  th {
    text-align: left;
    background-color: $table-header-bg;
    color: $body-color;
    padding: $spacing-xs;
    border-bottom: 2px solid $table-border-color;
    font-weight: bold;
    text-transform: uppercase;
  }

  td {
    padding: $spacing-xs;
    border-bottom: 1px solid lighten($table-border-color, 20%);
    color: $body-color;
    vertical-align: middle;
  }
}

// DataTable component sizing
.reveal .dataTables_wrapper .dataTables_length,
.reveal .dataTables_wrapper .dataTables_filter,
.reveal .dataTables_wrapper .dataTables_info,
.reveal .dataTables_wrapper .dataTables_processing,
.reveal .dataTables_wrapper .dataTables_paginate {
  font-size: 0.8em;
}

// ============================================================
// 9. Slide Type Classes
// ============================================================

.small-slide {
  font-size: $presentation-font-smaller;
}

.tiny-slide {
  font-size: $font-size-small;
}

.quote-slide {
  color: $heading-h2-color;
  font-size: $font-size-small;
  text-align: center;

  blockquote {
    font-style: italic;
    color: $heading-h3-color;
    border-left: 5px solid $heading-h1-color;
    padding-left: 20px;
  }
}

.image-slide {
  margin: 0;
  padding: 0;
  background-color: $body-bg;
  font-size: $font-size-tiny;

  h2 {
    font-size: 1em;
    color: $accent;
    background-color: $body-bg;
  }
}

.reveal .slides .section-slide {
  h1 {
    font-size: $presentation-h1-font-size;
    color: $heading-h2-color;
    text-align: center;
    border-bottom: 3px solid $accent;
    padding-bottom: $spacing-md;
    display: inline-block;
  }
}

.slide-code {
  font-size: $font-size-medium-small;
}

.large-image-slide {
  padding: 0;

  .reveal img {
    max-height: 80vh;
  }
}

.reveal .slides section[data-vertical-align-top] {
  top: 0;
}

// ============================================================
// 10. Emphasis Classes
// ============================================================

@mixin emphasis($bg-color, $border-color, $text-color,
  $padding-y: $spacing-xxs, $padding-x: $spacing-xs,
  $font-weight: normal, $font-style: normal, $border-radius: 4px) {
  background-color: $bg-color;
  padding: $padding-y $padding-x;
  margin: $spacing-xxs 0;
  border-radius: $border-radius;
  color: $text-color;
  font-weight: $font-weight;
  font-style: $font-style;
}

.alert {
  @include emphasis(
    rgba($emphasis-alert, 0.1), $emphasis-alert, $emphasis-alert,
    $spacing-xxs, $spacing-xxs, bold
  );
}

.fg {
  color: $emphasis-fg;
  font-weight: bold;
}

.bg {
  background-color: $emphasis-bg;
  padding: $spacing-xs $spacing-sm;
  border-radius: 4px;
  color: #ffffff;
}

.highlight {
  background-color: $emphasis-highlight;
  color: $body-color;
  padding: $spacing-xxs;
  margin: $spacing-md 0;
  border-radius: 2px;
}

.note {
  @include emphasis(
    rgba($emphasis-note, 0.1), $emphasis-note, $emphasis-note,
    $spacing-xxs, $spacing-xxs, normal, italic
  );
}

.warning {
  @include emphasis(
    rgba($emphasis-warning, 0.1), $emphasis-warning, $emphasis-warning,
    $spacing-xxs, $spacing-xxs, bold
  );
}

// ============================================================
// 11. Buttons
// ============================================================

.button {
  display: inline-block;
  padding: $spacing-xs $spacing-sm;
  margin-bottom: 0;
  font-size: $font-size-small;
  font-weight: 400;
  line-height: $line-height-body;
  text-align: center;
  white-space: nowrap;
  vertical-align: middle;
  cursor: pointer;
  background-color: $accent;
  border: 1px solid $accent;
  color: #ffffff !important;
  text-decoration: none;
  border-radius: 4px;
  transition: background-color 0.2s ease-in-out, border-color 0.2s ease-in-out;
}

.button:hover {
  background-color: darken($accent, 10%);
  border-color: darken($accent, 10%);
}

.button::before {
  content: "‚ñ∂";
  margin-right: 0.3125rem;
}

// ============================================================
// 12. Badge
// ============================================================

.badge {
  background-color: $badge-color;
  color: white;
  font-size: 0.85em;
  padding: 0.05em 0.3em;
  border-radius: 4px;
  vertical-align: baseline;
}

.badge-primary {
  background-color: $badge-color;
}

.badge-secondary {
  background-color: lighten($badge-color, 30%);
}

// ============================================================
// 13. Blockquote
// ============================================================

.reveal .blockquote {
  font-size: inherit;
  padding: 0 $spacing-md;
  color: $heading-h3-color;
  border-left: 0.25rem solid lighten($table-border-color, 20%);
  margin-bottom: $spacing-md;
}

// ============================================================
// 14. Citations & References
// ============================================================

.reveal .citation,
.reveal .citation a:hover {
  font-size: 0.8em;
  color: lighten($heading-h3-color, 20%);
}

.reveal .citation a {
  font-size: 0.8em;
  color: $heading-h3-color;
}

.references {
  font-size: 0.6em;
}

// ============================================================
// 15. Panel Tabset
// ============================================================

.reveal .panel-tabset [role=tab][aria-selected=true] {
  border: lighten($table-border-color, 20%) 2px solid;
  border-radius: 6px 6px 0 0;
  border-bottom: none;
}

.reveal .panel-tabset .tab-content {
  border-top: lighten($table-border-color, 20%) 2px solid;
}

.reveal .panel-tabset .panel-tabset-tabby {
  margin-bottom: 0;
}

// ============================================================
// 16. Title Slide
// ============================================================

#title-slide {

  .title,
  .subtitle {
    margin: 0;
    font-weight: bold;
    color: $heading-h2-color;
    font-family: $heading-font-family;
    line-height: $presentation-heading-line-height;
  }

  .title {
    font-size: $presentation-h1-font-size;
  }

  .subtitle {
    font-size: $presentation-h3-font-size;
    margin-bottom: $spacing-md;
  }

  .quarto-title-authors {
    font-size: 1.3em;
    display: block;
    margin: 0;
    padding-left: 0;
  }

  .quarto-title-author {
    padding-left: 0;
  }

  .institute,
  .quarto-title-author,
  .author {
    margin: 0;
    font-weight: normal;
    font-style: normal;
    font-size: $font-size-root;
    color: $accent;
  }

  .date {
    margin-bottom: $spacing-xxl;
    font-size: 1.1em;
    font-weight: normal;
    color: $accent;
  }
}

.reveal .slide-background-content {
  background-position: right;
}

// ============================================================
// 17. Logo, Slide Number & Menu
// ============================================================

.slide-logo {
  position: fixed;
  top: 5px;
  right: 10px;
  z-index: 1000;
  width: 100px;
  height: auto;
}

.logo img {
  width: 100%;
  height: auto;
}

.slide-number,
.reveal.has-logo .slide-number {
  bottom: 10px !important;
  right: 10px !important;
  top: unset !important;
  color: $body-color;
  font-family: $font-family-sans-serif;
}

.reveal .slide-menu-button {
  top: 10px;
  left: 10px;
  bottom: auto;
  position: absolute;
  z-index: 1000;
}

// Footer text ‚Äî persistent line at the bottom of every slide.
// Activated by RevealJS `footer` option in YAML front matter:
//   format:
//     dtslides-unm-revealjs:
//       footer: "STAT 440 ‚Äî Regression Analysis"
.reveal .footer {
  font-size: 0.5em;
  color: $heading-h3-color;
  opacity: 0.6;
  text-align: left;
  padding: 0 1em;
}

// Footer is hidden on the title slide via dtslides.js (RevealJS event),
// because .footer is a sibling of .slides, not a descendant of #title-slide.

// ============================================================
// 18. Standard Quarto Callouts (Enhanced)
// Use `div.callout` to match Quarto's built-in selector
// specificity (.reveal div.callout...) which otherwise wins.
// ============================================================

.reveal div.callout {
  border-radius: 0;
}

.reveal div.callout.callout-style-default,
.reveal div.callout.callout-style-simple {
  border: solid lighten($table-border-color, 20%) 1px;
}

.reveal div.callout.callout-style-simple div.callout-title,
.reveal div.callout.callout-style-default div.callout-title {
  font-size: 1.1em;
}

.reveal div.callout.callout-style-simple div.callout-content,
.reveal div.callout.callout-style-default div.callout-content {
  font-size: 0.95em;
}

.reveal div.callout.callout-titled .callout-title p {
  margin-top: 0.2em;
  margin-bottom: 0;
}

.reveal div.callout.callout-titled .callout-body > .callout-content > :last-child {
  margin-bottom: 0.1em;
}

.reveal div.callout.callout-style-simple .callout-icon::before,
.reveal div.callout.callout-style-default .callout-icon::before {
  height: 1em;
  width: 1em;
  background-size: 0.95em 0.95em;
}

.reveal div.callout.callout-titled .callout-icon::before {
  margin-top: 0.25em;
}

.reveal div.callout-note.callout-style-default .callout-title {
  background-color: $callout-note-title-bg;
}

// ============================================================
// 19. Custom Callouts
// ============================================================

.callout-example,
.callout-question,
.callout-insight {
  padding: $spacing-xxs $spacing-sm;
  margin: $spacing-xxs 0;
  border-left: 5px solid;
  border-radius: 6px;
  position: relative;

  p {
    margin: 0;
  }
}

.callout-example::before,
.callout-question::before,
.callout-insight::before {
  display: flex;
  align-items: center;
  font-weight: bold;
  font-size: 1em;
  margin-bottom: 0.1em;
}

.callout-example {
  border-left-color: $callout-example-color;
  background-color: rgba($callout-example-color, 0.08);

  &::before {
    content: "üìö Example";
    color: $callout-example-color;
  }
}

.callout-question {
  border-left-color: $callout-question-color;
  background-color: rgba($callout-question-color, 0.08);

  &::before {
    content: "‚ùì Question";
    color: $callout-question-color;
  }
}

.callout-insight {
  border-left-color: $callout-insight-color;
  background-color: rgba($callout-insight-color, 0.08);

  &::before {
    content: "üí° Insight";
    color: $callout-insight-color;
  }
}
